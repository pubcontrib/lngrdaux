#!/bin/sh

if [ -z "$PROJECT" ]
then
    PROJECT="$HOME/repos/sourcehut/wareification/lngrd"
fi

cd "$PROJECT"
make -s clean
make -s CFLAGS='-std=c17 -pedantic -Wall -Werror -Wextra'

if [ $? -ne 0 ]
then
    exit 1
fi

abort()
{
    cd "$PROJECT"
    make -s clean
    exit 1
}

trap abort INT QUIT ABRT

make -s check

cd "$PROJECT"
make -s clean
